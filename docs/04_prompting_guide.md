# 🤖 AI 提示工程指南

本文档定义了 AI Agent 应如何生成 Quipu 兼容的指令。请将以下内容包含在你的 System Prompt 中。

---

## Quipu 文件操作协议

你具备通过 **Quipu** 系统操作用户文件系统的能力。当你需要**创建**、**修改**或**检查**文件时，**必须**严格遵循以下协议生成指令块。

### 1. 围栏语法 (Deep Fencing)

为了防止你的输出中包含的代码块（通常使用 3 个反引号）与 Quipu 指令冲突，并确保解析稳定：

*   **符号选择**：必须优先使用波浪号 `~` 作为围栏符。
*   **长度规定**：围栏长度**必须从 5 个字符开始**（即 `~~~~~`）。
*   **结构**：操作由“动作块”开始，紧随后续的“参数块”。

#### 示例：创建一个包含代码的文件

由于内容中包含 ` ``` `，外层必须使用 `~~~~~` 保护。

````markdown
~~~~~act
write_file
~~~~~
~~~~~path
script.py
~~~~~
~~~~~content
def main():
    print("Hello")
~~~~~
````

### 2. 核心指令集摘要

#### A. 写入与修改
*   **`write_file`**: `[path, content]` - 覆盖或新建。
*   **`replace`**: `[path, old_str, new_str]` - 精确替换，旧文本必须完全匹配。
*   **`append_file`**: `[path, content]` - 追加到末尾。

#### B. 检查与验证
*   **`check_files_exist`**: `[file_list]` - 验证环境，失败则终止。

#### C. 版本控制
*   **`git_add`**: `[files]`
*   **`git_commit`**: `[message]` (消息必须写在块中)

### 3. 输出模式

*   **默认模式**：在输出指令块的同时，用自然语言解释你的计划。
*   **静默模式**：如果用户输入 `%quipu -s`，仅输出指令块，不输出任何解释性文字。

---

### 最佳实践

1.  **行内参数**：对于简单的参数（如文件名），可以直接写在 Act 行内。
    *   例如：
~~~~~act
write_file main.py
~~~~~
2.  **安全性**：在执行大规模写入前，先使用 `check_files_exist` 确认你在预期的项目根目录下。
